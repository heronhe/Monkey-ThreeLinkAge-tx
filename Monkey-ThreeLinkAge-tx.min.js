var MK_ThreeLinkAge=(function(){var c,d;function b(e,f){var g=document.createElement("option");g.innerHTML=e;if(f){g.value=f;}return g;}function a(g){var e=this;
this.oProvice=g.provice||null;this.oCity=g.city;this.oDistrict=g.district;this.locationStates=g.location;this.success=g.success;this.updateCity=g.updateCity;
this.updateProvice=g.updateProvice;this.updateDistrict=g.updateDistrict;this.defaultText=g.defaultText||["城市","专柜"];this.addDefaultText=g.addDefaultText;
this.counterParam=this.setCounterId(g.data);this.init();if(this.locationStates){if(c){e.getDistance(c);}else{if(!d){d=document.createElement("iframe");
d.setAttribute("style","display:none");d.setAttribute("src","https://apis.map.qq.com/tools/geolocation?key=Q4EBZ-K2ORG-OSTQI-IKLRD-NTOXV-7DBVG&referer=pmlMap&effect=zoom");
document.body.appendChild(d);}var f=function(j){var m=j.data;if(m&&m.module=="geolocation"){var p={lat:m.lat,lng:m.lng};c=p;if(!e.oProvice){var k=[],i=m.city,h=e.counterParam[0];
for(var o=0,l=h.length;o<l;o++){if(h[o].c==i){k.push(h[o]);}}if(k.length>0){e.counterParam[0]=k;}}e.getDistance(p);window.removeEventListener("message",f);
}};window.addEventListener("message",f,false);}}this.changeHandler();}a.prototype={init:function(){var e=this;if(!e.oProvice){e.defaultText.splice(0,0,"");
}if(e.addDefaultText){if(e.oProvice){e.oProvice.appendChild(b(e.defaultText[0]));}e.oCity.appendChild(b(e.defaultText[1]));if(e.oDistrict){e.oDistrict.appendChild(b(e.defaultText[2]));
}}if(e.oProvice){for(var f=0,h=e.counterParam[1].length;f<h;f++){e.oProvice.appendChild(b(e.counterParam[1][f]));}}else{var g=e.counterParam[2].all;for(var f=0,h=g.length;
f<h;f++){e.oCity.appendChild(b(g[f]));}}},changeHandler:function(){var e=this;if(e.oProvice){e.oProvice.addEventListener("change",function(){var f=e.oProvice.value;
e.oCity.length=1;if(e.oDistrict){e.oDistrict.length=1;}if(f==e.defaultText[0]){return;}for(var g=0;g<e.counterParam[2][f].length;g++){e.oCity.appendChild(b(e.counterParam[2][f][g]));
}if(typeof e.updateProvice==="function"){e.updateProvice({msg:"更新成功"});}},false);}e.oCity.addEventListener("change",function(){var g=e.oCity.value;if(e.oDistrict){e.oDistrict.length=1;
}if(g==e.defaultText[1]){if(typeof e.updateCity==="function"){e.updateCity([]);}return;}if(e.oDistrict){for(var f=0;f<e.counterParam[3][g].length;f++){e.oDistrict.appendChild(b(e.counterParam[3][g][f].counterName,e.counterParam[3][g][f].id));
}}if(typeof e.updateCity==="function"){e.updateCity(e.counterParam[3][g]);}},false);if(e.oDistrict){e.oDistrict.addEventListener("change",function(){if(typeof e.updateDistrict==="function"){e.updateDistrict();
}},false);}},getDistance:function(l){var h=this;var g=new qq.maps.LatLng(l.lat,l.lng),k=h.counterParam[0].length;if(k<1){return;}for(var j=0;j<k;j++){var f=h.counterParam[0][j].lc.split(",");
var e=new qq.maps.LatLng(f[1],f[0]);h.counterParam[0][j].dist=parseInt(qq.maps.geometry.spherical.computeDistanceBetween(g,e));}h.setDefaultVal();},setDefaultVal:function(){var r=this;
var q=r.sortObJ(r.counterParam[0],"dist");var o=q[0];var l,n,m;if(r.oProvice){for(var g=0;g<r.oProvice.options.length;g++){if(r.locationStates){if(r.oProvice.options[g].value===o.p){r.oProvice.options[g].selected=true;
}}}if(typeof r.updateProvice==="function"){r.updateProvice();}}var h;o.p=r.oProvice?o.p:"all";r.oCity.length=1;for(var f=0;f<r.counterParam[2][o.p].length;
f++){n=document.createElement("option");h=r.counterParam[2][o.p][f];n.innerHTML=h;r.oCity.appendChild(n);if(r.locationStates){if(h==o.c){n.selected=true;
}}}if(typeof r.updateCity==="function"){r.updateCity();}var p;if(r.oDistrict){r.oDistrict.length=1;for(var e=0;e<r.counterParam[3][o.c].length;e++){m=document.createElement("option");
p=r.counterParam[3][o.c][e];m.innerHTML=p.counterName;this.oDistrict.appendChild(m);if(r.locationStates){if(p.counterName==o.cn){m.selected=true;}}}if(typeof r.updateDistrict==="function"){r.updateDistrict();
}}if(typeof r.success==="function"){r.success({data:true});}},sortObJ:function(g,h){var l;for(var f=0,k=g.length-1;f<k;f++){for(var e=0;e<k-f;e++){if(g[e][h]>g[e+1][h]){l=g[e+1];
g[e+1]=g[e];g[e]=l;}}}return g;},setCounterId:function(m){var v=this,p=[],u=[],t={},w={},g,h,e,q;for(var l=0,o=v.oProvice?m.length:1;l<o;l++){if(v.oProvice){e=m[l].name;
u.push(e);t[e]=[];g=m[l].list;}else{g=m;t.all=[];}for(var k=0,s=g.length;k<s;k++){q=g[k].name;w[q]=[];if(v.oProvice){t[e].push(q);}else{t.all.push(q);}h=g[k].list;
for(var f=0,r=h.length;f<r;f++){p.push({id:h[f].counterId,p:e||null,c:q,cn:h[f].counterName,lc:h[f].location});w[q].push({city:q,id:h[f].counterId,counterName:h[f].counterName,address:h[f].address||""});
}}}return[p,u,t,w];}};a.prototype.constructor=a;return a;})();